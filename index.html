<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    


  <form action="" class="form-cria-campo">

  
    <div class="campo-input">
        <label for="">Nome do campo</label>
        <input type="text" name="nome-campo" id="nome-campo" required>
    </div>
    
    <div class="campo-input">
         <label for="">Selecione o tipo</label>
        <select name="tipo" id="tipo-campo">
            <option value="">Selecione</option>
            <option value="um">Um</option>
            <option value="dois">Dois</option>
            <option value="tres">Três</option>
        </select>
    </div>
   



     <div class="option-container">
        <div class="input-criar-option">
            <div class="input-add-option">
                <label for="">Cria opção</label>
                <input type="text" name="novo-option" id="input-option">
            </div>

            <button type="button" class="add-option">Adicionar</button>
            
        </div>
         



        <div class="option-lista">
           <h4>Lista</h4>
           
           <div class="msg-option">
               <p>Adicione opções</p>
           </div>

           <div class="option-item">
              <input  type='text'  name='item3' value="item1">

              <div class="btns-option">
                
                <button type="button" class="remove-option">Remover</button>
              </div>
           </div>

        


           <div class="option-item">
              <input  type='text'  name='valor' value="item3">

              <div class="btns-option">
                <!-- <button class="editar-option">Editar</button> -->
                <button type="button" class="remove-option">Remover</button>
              </div>


           </div>

        </div>


     </div>


       <button type="button" class="salvar-campo">Salvar</button>
  </form>



  <form action="" id="novo-form">
    <div class="novoCampo">
        <div>
            <label>listas</label>
            <div>
                <button type="button" class="editar-campo" onclick='editarCampo(this)'>Editar</button>
                <button type="button" class="remove-campo" onclick="removerCampo(this)"> X</button>
            </div>
        </div>
         <select name="listas">
            <option value="item1">item1</option><option value="item3">item3</option>
          </select>

            
    </div>

  </form>
    



  <form action="" class="form-edit-campo">

  
    <div class="campo-input">
        <label for="">Nome do campo</label>
        <input type="text" name="nome-campo" id="nome-campo" required>
    </div>
    
    <div class="campo-input">
         <label for="">Selecione o tipo</label>
        <select name="tipo" id="tipo-campo">
            <option value="">Selecione</option>
            <option value="um">Um</option>
            <option value="dois">Dois</option>
            <option value="tres">Três</option>
        </select>
    </div>
   



     <div class="option-container">
        <div class="input-criar-option">
            <div class="input-add-option">
                <label for="">Cria opção</label>
                <input type="text" name="novo-option" id="input-option">
            </div>

            <button type="button" class="add-option">Adicionar</button>
            
        </div>
         



        <div class="option-lista editar-campo">
           <h4>Lista</h4>
           
           <div class="msg-option">
               <p>Adicione opções</p>
           </div>

           

        </div>


     </div>


       <button type="button" class="salvar-campo-edit">Salvar</button>
  </form>




    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>



    <script>
        $('#tipo-campo').on('change', function() {
            console.log( this.value );

            if(this.value == "tres"){
                console.log( "Lista" );

                $('.option-container').css('display', 'block');

            }else{
                $('.option-container').css('display', 'none');
                //$('.option-item').remove()

            }
        });
       


       

      

        $('.add-option').on("click", function(){
            
            var option= $('#input-option').val();

            if(!option){
                console.log('vazio');

            }else{
                console.log(option)

                var novoItem = document.createElement('div');
                novoItem.classList.add('option-item')
            
                // Conteúdo HTML do novo item
                novoItem.innerHTML = `
                        <input  type='text'  name='${option}' value="${option}">

                        <div class="btns-option">
                            <button type='button'  class="remove-option">Remover</button>
                        </div>
                `;


                $('.option-lista').append(novoItem);
                $('#input-option').val('');


                
            }
             
            //verifica qtd de option
            if($('.option-lista').find('.option-item').length !== 0){
              
               $('.msg-option').css('display','none')
            }
            
        })
        

       
        //remover option
        $('.option-lista').on("click", ".remove-option", function(){
            $(this).closest('.option-item').remove()
            console.log('removeu')
           
           //verifica qtd de option
           if($('.option-lista').find('.option-item').length == 0){
               console.log($('.option-lista').find('.option-item').length, "qtd")

               $('.msg-option').css('display','flex')
           }
        });
        


        $('.salvar-campo').on('click', function() {
            

            var tipo_campo = document.getElementById('tipo-campo').value;
            var nome_campo = document.getElementById('nome-campo').value;
            

            if(tipo_campo == "tres"){

                
                var inputs = document.querySelectorAll(".option-item input");
                var lista_opcoes = [];

               

                for (var i = 0; i < inputs.length; i++) {
                    lista_opcoes.push(inputs[i].value);
                }

                if(lista_opcoes != 0){
                    var novoSelect = document.createElement('div');
                    novoSelect.classList.add('novoCampo')
                
                    // Conteúdo HTML do novo item
 
                    var opcoesHTML = lista_opcoes.map(item => `<option value="${item}">${item}</option>`).join('');
                    
                    novoSelect.innerHTML = `
                        <div>
                            <label >${nome_campo}</label>
                            <div>
                                <button type='button' class='editar-campo' onclick='editarCampo(this)'>Editar</button>
                                <button type='button' class='remove-campo' onclick='removerCampo(this)'> X</button>
                            </div>
                        </div>
                         <select name='${nome_campo}'>
                            ${opcoesHTML}
                          </select>

                            
                    `;
                     
                

                    $('#novo-form').append(novoSelect);
                    

                }

               



            }else if(tipo_campo == "um"){

                   var novoInput = document.createElement('div');
                    novoInput.classList.add('novoCampo')
                
                    // Conteúdo HTML do novo item
 
                    
                    novoInput.innerHTML = `
                        <div>
                            <label >${nome_campo}</label>
                            <div>
                                <button type='button' class='editar-campo' onclick='editarCampo(this)'>Editar</button>
                                <button type='button' class='remove-campo' onclick='removerCampo(this)'> X</button>
                            </div>
                        </div>
                         <input name='${nome_campo}'>

                            
                    `;
                     
                

                    $('#novo-form').append(novoInput);
            }

            
            
            
        });

        
        //remove campo
        function removerCampo(button) {
            const campoContainer = button.closest(".novoCampo");
            campoContainer.remove();
        }



        function editarCampo(button) {
            const campoContainer = $(button).closest(".novoCampo");
            const selectElement = campoContainer.find("select");

            if (selectElement.length > 0) {
                

                var select_name = selectElement.attr('name');

                $('.form-edit-campo #nome-campo ').attr('value', select_name );

                
                $('.form-edit-campo #tipo-campo').val("tres").change();


                
                var option_campo_edit = selectElement.find("option");
                  
                var lista_opcoes_edit = [];

               

                for (var i = 0; i < option_campo_edit.length; i++) {
                    lista_opcoes_edit.push(option_campo_edit[i].value);
                }
                
                console.log(lista_opcoes_edit, 'valores');

                lista_opcoes_edit.forEach(element => {
                    
                

                    var optionItem = document.createElement('div');
                    optionItem.classList.add('option-item')
                
                        // Conteúdo HTML do novo item
    
                        
                        optionItem.innerHTML = `
                            
    
                                <input  type='text'  name='${element}' value="${element}">

                                <div class="btns-option">
                                    
                                    <button type="button" class="remove-option">Remover</button>
                                </div>
                                
                        `;

                    
                    $('.option-lista.editar-campo').append(optionItem);


                });


                
                


            } else {
                console.log("O .novoCampo NÃO contém um elemento <select>.");
            }
                        
            


            $(campoContainer).css('background', 'red');
        }

        
        

        $('.salvar-campo-edit').on('click', function() {
            

            var tipo_campo = document.getElementById('tipo-campo').value;
            var nome_campo = document.getElementById('nome-campo').value;
            

            if(tipo_campo == "tres"){

                
                var inputs = document.querySelectorAll(".option-item input");
                var lista_opcoes = [];

               

                for (var i = 0; i < inputs.length; i++) {
                    lista_opcoes.push(inputs[i].value);
                }

                if(lista_opcoes != 0){
                    var novoSelect = document.createElement('div');
                    novoSelect.classList.add('novoCampo')
                
                    // Conteúdo HTML do novo item
 
                    var opcoesHTML = lista_opcoes.map(item => `<option value="${item}">${item}</option>`).join('');
                    
                    novoSelect.innerHTML = `
                        <div>
                            <label >${nome_campo}</label>
                            <div>
                                <button type='button' class='editar-campo' onclick='editarCampo(this)'>Editar</button>
                                <button type='button' class='remove-campo' onclick='removerCampo(this)'> X</button>
                            </div>
                        </div>
                         <select name='${nome_campo}'>
                            ${opcoesHTML}
                          </select>

                            
                    `;
                     
                

                    $('#novo-form').append(novoSelect);
                    

                }

               



            }

            
            
            
        });
    </script>


</body>
</html>