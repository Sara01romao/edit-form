<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    

 <div class="modal-criar-campo">
    <div class="modal-campo-container">
        <button class="close-modal-add">x</button>
        
        <h2>title</h2>

        <form action="" class="form-cria-campo">

        
            <div class="campo-input">
                <label for="">Nome do campo</label>
                <input type="text" name="nome-campo" id="nome-campo" required>
            </div>
            
            <div class="campo-input">
                <label for="">Selecione o tipo</label>
                <select name="tipo" id="tipo-campo">
                    <option value="">Selecione</option>
                    <option value="um">Um</option>
                    <option value="dois">Dois</option>
                    <option value="tres">Três</option>
                </select>
            </div>
        
            <div class="option-container">
                <div class="input-criar-option">
                    <div class="input-add-option">
                        <label for="">Cria opção</label>
                        <input type="text" name="novo-option" id="input-option">
                    </div>
        
                    <button type="button" class="add-option">Adicionar</button>
                    
                </div>
                
        
        
        
                <div class="option-lista">
                <h4>Lista</h4>
                
                <div class="msg-option">
                    <p>Adicione opções</p>
                </div>
        
                <!-- <div class="option-item">
                    <input  type='text'  name='item3' value="item1">
        
                    <div class="btns-option">
                        
                        <button type="button" class="remove-option">Remover</button>
                    </div>
                </div> -->
        
                
        
        
                
        
                </div>
        
        
            </div>
        
        
            <button type="button" class="salvar-campo">Salvar</button>
        </form>
    </div>
 </div>
  



  <form action="" id="novo-form">
     
     <div>
        <label for="">Nome Form</label>
        <input type="text">
             
     </div>

     <div class="criar-campo-title">
        <h4>Campo</h4>
        <button type="button" class="open-modal-add">+ Novo Campo</button>
     </div>
     
    <div class="novoCampo" id="campo_0">
        <div>
            <label>listas</label>
            <div>
                <button type="button" class="editar-campo" onclick='editarCampo(this)'>
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M7.95001 2.54937L11.4505 6.04997L3.84938 13.6514L0.728442 13.9959C0.31064 14.0421 -0.0423582 13.6888 0.00412498 13.271L0.351382 10.1478L7.95001 2.54937ZM13.6155 2.02819L11.9719 0.384528C11.4592 -0.128176 10.6277 -0.128176 10.115 0.384528L8.56878 1.93084L12.0692 5.43145L13.6155 3.88513C14.1282 3.37215 14.1282 2.54089 13.6155 2.02819Z" fill="#262626"></path>
                    </svg>
                </button>
                <button type="button" class="remove-campo" onclick="removerCampo(this)"> X</button>
            </div>
        </div>
         <select name="listas">
            <option value="item1">item1</option><option value="item3">item3</option>
          </select>

            
    </div>

    <div class="novoCampo" id="campo_1699287220905">
        <div>
            <label>Nome</label>
            <div>
                <button type="button" class="editar-campo" onclick="editarCampo(this)">
                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M7.95001 2.54937L11.4505 6.04997L3.84938 13.6514L0.728442 13.9959C0.31064 14.0421 -0.0423582 13.6888 0.00412498 13.271L0.351382 10.1478L7.95001 2.54937ZM13.6155 2.02819L11.9719 0.384528C11.4592 -0.128176 10.6277 -0.128176 10.115 0.384528L8.56878 1.93084L12.0692 5.43145L13.6155 3.88513C14.1282 3.37215 14.1282 2.54089 13.6155 2.02819Z" fill="#262626"></path>
                    </svg>
                </button>
                <button type="button" class="remove-campo" onclick="removerCampo(this)"> X</button>
            </div>
        </div>
        <input name="Nome">

            
    </div>


    <div class="novoCampo" id="campo_1699288771532">
        <div>
            <label>msg</label>
            
            <div>
                <button type="button" class="editar-campo" onclick="editarCampo(this)">Editar</button>
                <button type="button" class="remove-campo" onclick="removerCampo(this)"> X</button>
            </div>
        </div>
        
        <textarea name="msg" style=""></textarea>

            
    </div>

  </form>
    



  <form action="" class="form-edit-campo">

  
    <div class="campo-input">
        <label for="">Nome do campo</label>
        <input type="text" name="nome-campo" id="nome-campo-edit" required>
        <small class="erro-campo">Preencha o campo</small>
        <input type="text" name="id-campo" id="id-campo" disabled="disabled">
    </div>
    
    <div class="campo-input">
         <label for="">Selecione o tipo</label>
        <select name="tipo" id="tipo-campo-edit">
            <option value="">Selecione</option>
            <option value="um">Um</option>
            <option value="dois">Dois</option>
            <option value="tres">Três</option>
        </select>
    </div>
   



     <div class="option-container">
        <div class="input-criar-option">
            <div class="input-add-option">
                <label for="">Cria opção</label>
                <input type="text" name="novo-option" id="input-option-edit">
            </div>

            <button type="button" class="add-option-edit">Adicionar</button>
            
        </div>
         



        <div class="option-lista-edit editar-campo">
           <h4>Lista</h4>
           
           <div class="msg-option">
               <p>Adicione opções</p>
           </div>

           

        </div>


     </div>


       <button type="button" class="salvar-campo-edit">Salvar</button>
  </form>
 

  



    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>



    <script>
        $('#tipo-campo').on('change', function() {
            console.log( this.value );

            if(this.value == "tres"){
                console.log( "Lista" );

                $('.option-container').css('display', 'block');

            }else{
                $('.option-container').css('display', 'none');
                //$('.option-item').remove()

            }
        });
       

        //fecha modal de add campo
        $('.close-modal-add').on("click", function(){
            
                $('#nome-campo').val('');
                
                $('#tipo-campo').val('');
                $('.option-lista .option-item').remove();

                $('.modal-criar-campo').css('display','none')
                $('#input-option').val('');
                

            
        })

        //abre modal de add campo
        $('.open-modal-add').on("click", function(){
            
                

                $('.modal-criar-campo').css('display','flex')
                

            
        })

      

        $('.add-option').on("click", function(){
            
            var option= $('#input-option').val();

            if(!option){
                console.log('vazio');

            }else{
                console.log(option)

                var novoItem = document.createElement('div');
                novoItem.classList.add('option-item')
            
                // Conteúdo HTML do novo item
                novoItem.innerHTML = `
                        <input  type='text'  name='${option}' value="${option}">

                        <div class="btns-option">
                            <button type='button'  class="remove-option">X</button>
                        </div>
                `;


                $('.option-lista').append(novoItem);
                $('#input-option').val('');


                
            }
             
            //verifica qtd de option
            if($('.option-lista').find('.option-item').length !== 0){
              
               $('.msg-option').css('display','none')
            }
            
        })
        

       
        //remover option
        $('.option-lista').on("click", ".remove-option", function(){
            $(this).closest('.option-item').remove()
            console.log('removeu')
            
            //verifica qtd de option
            if($('.option-lista').find('.option-item').length == 0){
                console.log($('.option-lista').find('.option-item').length, "qtd")

                $('.msg-option').css('display','flex')
            }
        });
        


        $('.salvar-campo').on('click', function() {
            

            var tipo_campo = document.getElementById('tipo-campo').value;
            var nome_campo = document.getElementById('nome-campo').value;
            
            if(nome_campo !== ''){

                if(tipo_campo == "tres"){

                    
                    var inputs = document.querySelectorAll(".option-item input");
                    var lista_opcoes = [];

                

                    for (var i = 0; i < inputs.length; i++) {
                        lista_opcoes.push(inputs[i].value);
                    }

                    if(lista_opcoes != 0){
                        var novoSelect = document.createElement('div');
                        novoSelect.classList.add('novoCampo')

                        var novoCampoId = 'campo_' + Date.now();
                        novoSelect.id=novoCampoId;
                    
                        // Conteúdo HTML do novo item
    
                        var opcoesHTML = lista_opcoes.map(item => `<option value="${item}">${item}</option>`).join('');
                        
                        novoSelect.innerHTML = `
                            <div>
                                <label >${nome_campo}</label>
                                <div>
                                    <button type='button' class='editar-campo' onclick='editarCampo(this)'>
                                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M7.95001 2.54937L11.4505 6.04997L3.84938 13.6514L0.728442 13.9959C0.31064 14.0421 -0.0423582 13.6888 0.00412498 13.271L0.351382 10.1478L7.95001 2.54937ZM13.6155 2.02819L11.9719 0.384528C11.4592 -0.128176 10.6277 -0.128176 10.115 0.384528L8.56878 1.93084L12.0692 5.43145L13.6155 3.88513C14.1282 3.37215 14.1282 2.54089 13.6155 2.02819Z" fill="#262626"/>
                                        </svg>
                                            
                                    </button>
                                    <button type='button' class='remove-campo' onclick='removerCampo(this)'> X</button>
                                </div>
                            </div>
                            <select name='${nome_campo}'>
                                ${opcoesHTML}
                            </select>

                                
                        `;
                        
                    

                        $('#novo-form').append(novoSelect);
                        

                    }

                



                }else if(tipo_campo == "um"){

                    var novoInput = document.createElement('div');
                        novoInput.classList.add('novoCampo');

                        var novoCampoId = 'campo_' + Date.now();
                        novoInput.id=novoCampoId;
                    
                    
                        // Conteúdo HTML do novo item
    
                        
                        novoInput.innerHTML = `
                            <div>
                                <label >${nome_campo}</label>
                                <div>
                                    <button type='button' class='editar-campo' onclick='editarCampo(this)'>
                                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M7.95001 2.54937L11.4505 6.04997L3.84938 13.6514L0.728442 13.9959C0.31064 14.0421 -0.0423582 13.6888 0.00412498 13.271L0.351382 10.1478L7.95001 2.54937ZM13.6155 2.02819L11.9719 0.384528C11.4592 -0.128176 10.6277 -0.128176 10.115 0.384528L8.56878 1.93084L12.0692 5.43145L13.6155 3.88513C14.1282 3.37215 14.1282 2.54089 13.6155 2.02819Z" fill="#262626"/>
                                        </svg>
                                    </button>
                                    <button type='button' class='remove-campo' onclick='removerCampo(this)'> X</button>
                                </div>
                            </div>
                            <input name='${nome_campo}'>

                                
                        `;
                        
                    
                        $('.option-item').remove()
                        $('#novo-form').append(novoInput);

                }else if(tipo_campo == "dois"){

                    var novoTextarea = document.createElement('div');
                    novoTextarea.classList.add('novoCampo');
                    var novoCampoId = 'campo_' + Date.now();
                        novoTextarea.id=novoCampoId;

                    // Conteúdo HTML do novo item

                    
                    novoTextarea.innerHTML = `
                        <div>
                            <label >${nome_campo}</label>
                            
                            <div>
                                <button type='button' class='editar-campo' onclick='editarCampo(this)'>
                                    <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M7.95001 2.54937L11.4505 6.04997L3.84938 13.6514L0.728442 13.9959C0.31064 14.0421 -0.0423582 13.6888 0.00412498 13.271L0.351382 10.1478L7.95001 2.54937ZM13.6155 2.02819L11.9719 0.384528C11.4592 -0.128176 10.6277 -0.128176 10.115 0.384528L8.56878 1.93084L12.0692 5.43145L13.6155 3.88513C14.1282 3.37215 14.1282 2.54089 13.6155 2.02819Z" fill="#262626"/>
                                    </svg>    
                                </button>
                                <button type='button' class='remove-campo' onclick='removerCampo(this)'> X</button>
                            </div>
                        </div>
                        
                        <textarea name='${nome_campo}'></textarea>

                            
                    `;
                    

                        $('.option-lista .option-item').remove()
                        $('#novo-form').append(novoTextarea);
                }

                 // Limpe os campos após a edição e o salvamento
                    $('#nome-campo').val('');
                    
                    $('#tipo-campo').val('');
                    $('.option-lista .option-item').remove();
                    $('.modal-criar-campo').css('display','none')

            }
            
            
        });

//-----------------REMOVER-----------------------------------------------------------
       
        //remove campo
        function removerCampo(button) {
            const campoContainer = button.closest(".novoCampo");
            campoContainer.remove();
        }



//-----------------EDITAR-----------------------------------------------------------

        function editarCampo(button) {
            const campoContainer = $(button).closest(".novoCampo");
            var idCampo = campoContainer.attr('id');
            const selectElement = campoContainer.find("select");
            
            const inputElement = campoContainer.find("input");
            const textareaElement = campoContainer.find("textarea");
              
            
            $('#id-campo').val(idCampo);
            
            

            if (selectElement.length > 0) {
                
                var select_name = selectElement.attr('name');
                $('.form-edit-campo #nome-campo-edit ').val(select_name );
              
                $('.form-edit-campo #tipo-campo-edit').val("tres").change();

                
                var option_campo_edit = selectElement.find("option");
                  
                var lista_opcoes_edit = [];

               

                for (var i = 0; i < option_campo_edit.length; i++) {
                    lista_opcoes_edit.push(option_campo_edit[i].value);
                }
                
                console.log(lista_opcoes_edit, 'valores');

                lista_opcoes_edit.forEach(element => {
                    
                

                    var optionItem = document.createElement('div');
                    optionItem.classList.add('option-item')
                
                        // Conteúdo HTML do novo item
    
                        
                        optionItem.innerHTML = `
                            
    
                                <input  type='text'  name='${element}' value="${element}">

                                <div class="btns-option">
                                    
                                    <button type="button" class="remove-option">x</button>
                                </div>
                                
                        `;

                    
                    $('.option-lista-edit.editar-campo').append(optionItem);





                });

                  //verifica qtd de option
                if($('.option-lista-edit').find('.option-item').length !== 0){
                
                    $('.msg-option').css('display','none')
                }


                
                


            } else if(inputElement.length > 0){
                var input_name = inputElement.attr('name');
                $('.form-edit-campo #nome-campo-edit ').val(input_name );
              
                $('.form-edit-campo #tipo-campo-edit').val("um").change();

            }else if(textareaElement.length > 0){
                var textarea_name = textareaElement.attr('name');
                $('.form-edit-campo #nome-campo-edit ').val(textarea_name);
              
                $('.form-edit-campo #tipo-campo-edit').val("dois").change();

            }
                        
            


            
        }
        


        $('.add-option-edit').on("click", function(){
            
            var option= $('#input-option-edit').val();

            if(!option){
                console.log('vazio');

            }else{
                console.log(option)

                var novoItem = document.createElement('div');
                novoItem.classList.add('option-item')
            
                // Conteúdo HTML do novo item
                novoItem.innerHTML = `
                        <input  type='text'  name='${option}' value="${option}">

                        <div class="btns-option">
                            <button type='button'  class="remove-option">Remover</button>
                        </div>
                `;


                $('.option-lista-edit').append(novoItem);
                $('#input-option-edit').val('');


                
            }
             
           
            
        })


          //remover option
          $('.option-lista-edit').on("click", ".remove-option", function(){
            $(this).closest('.option-item').remove()
            console.log('removeu')
            
            //verifica qtd de option
            if($('.option-lista-edit').find('.option-item').length == 0){
                console.log($('.option-lista').find('.option-item').length, "qtd")

               $('.msg-option').css('display','flex')
            }
        });
        
        

        $('#tipo-campo-edit').on('change', function() {
            console.log( this.value );

            if(this.value == "tres"){
                console.log( "Lista" );

                $('.option-container').css('display', 'block');

            }else{
                $('.option-container').css('display', 'none');
                //$('.option-item').remove()

            }
        });



        $('.salvar-campo-edit').on('click', function() {
            

            var tipo_campo = document.getElementById('tipo-campo-edit').value;
            var nome_campo = document.getElementById('nome-campo-edit').value;
            var id_campo = document.getElementById('id-campo').value;

            console.log(tipo_campo, id_campo, nome_campo)
           
            if(nome_campo !== ''){

                    if(tipo_campo == "tres"){

                        
                        var inputs = document.querySelectorAll(".option-lista-edit .option-item input");
                        var lista_opcoes = [];

                    

                        for (var i = 0; i < inputs.length; i++) {
                            lista_opcoes.push(inputs[i].value);
                        }

                        if(lista_opcoes != 0){
                            var novoSelect = document.createElement('div');
                            novoSelect.classList.add('novoCampo');
                            novoSelect.id=id_campo;
                        
                            // Conteúdo HTML do novo item
        
                            var opcoesHTML = lista_opcoes.map(item => `<option value="${item}">${item}</option>`).join('');
                            
                            novoSelect.innerHTML = `
                                <div>
                                    <label >${nome_campo}</label>
                                    <div>
                                        <button type='button' class='editar-campo' onclick='editarCampo(this)'>
                                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M7.95001 2.54937L11.4505 6.04997L3.84938 13.6514L0.728442 13.9959C0.31064 14.0421 -0.0423582 13.6888 0.00412498 13.271L0.351382 10.1478L7.95001 2.54937ZM13.6155 2.02819L11.9719 0.384528C11.4592 -0.128176 10.6277 -0.128176 10.115 0.384528L8.56878 1.93084L12.0692 5.43145L13.6155 3.88513C14.1282 3.37215 14.1282 2.54089 13.6155 2.02819Z" fill="#262626"/>
                                            </svg>
                                        </button>
                                        <button type='button' class='remove-campo' onclick='removerCampo(this)'> X</button>
                                    </div>
                                </div>
                                <select name='${nome_campo}'>
                                    ${opcoesHTML}
                                </select>

                                    
                            `;
                            
                            

                            $('#novo-form').find('#'+id_campo).replaceWith(novoSelect);
                            //$('#novo-form').append(novoSelect);
                            
                            
                            

                        }

                    
                            


                    }else if(tipo_campo == "um"){

                        var novoInput = document.createElement('div');
                            novoInput.classList.add('novoCampo');

                            var novoCampoId = 'campo_' + Date.now();
                            novoInput.id=novoCampoId;


                            // Conteúdo HTML do novo item

                            
                            novoInput.innerHTML = `
                                <div>
                                    <label >${nome_campo}</label>
                                    <div>
                                        <button type='button' class='editar-campo' onclick='editarCampo(this)'>
                                            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M7.95001 2.54937L11.4505 6.04997L3.84938 13.6514L0.728442 13.9959C0.31064 14.0421 -0.0423582 13.6888 0.00412498 13.271L0.351382 10.1478L7.95001 2.54937ZM13.6155 2.02819L11.9719 0.384528C11.4592 -0.128176 10.6277 -0.128176 10.115 0.384528L8.56878 1.93084L12.0692 5.43145L13.6155 3.88513C14.1282 3.37215 14.1282 2.54089 13.6155 2.02819Z" fill="#262626"/>
                                            </svg>
                                        </button>
                                        <button type='button' class='remove-campo' onclick='removerCampo(this)'> X</button>
                                    </div>
                                </div>
                                <input name='${nome_campo}'>

                                    
                            `;
                            

                            $('#novo-form').find('#'+id_campo).replaceWith(novoInput);

                    }else if(tipo_campo == "dois"){

                        var novoTextarea = document.createElement('div');
                        novoTextarea.classList.add('novoCampo');
                        var novoCampoId = 'campo_' + Date.now();
                            novoTextarea.id=novoCampoId;

                        // Conteúdo HTML do novo item


                        novoTextarea.innerHTML = `
                            <div>
                                <label >${nome_campo}</label>
                                
                                <div>
                                    <button type='button' class='editar-campo' onclick='editarCampo(this)'>
                                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M7.95001 2.54937L11.4505 6.04997L3.84938 13.6514L0.728442 13.9959C0.31064 14.0421 -0.0423582 13.6888 0.00412498 13.271L0.351382 10.1478L7.95001 2.54937ZM13.6155 2.02819L11.9719 0.384528C11.4592 -0.128176 10.6277 -0.128176 10.115 0.384528L8.56878 1.93084L12.0692 5.43145L13.6155 3.88513C14.1282 3.37215 14.1282 2.54089 13.6155 2.02819Z" fill="#262626"/>
                                        </svg>    
                                    </button>
                                    <button type='button' class='remove-campo' onclick='removerCampo(this)'> X</button>
                                </div>
                            </div>
                            
                            <textarea name='${nome_campo}'></textarea>

                                
                        `;


                        $('#novo-form').find('#'+id_campo).replaceWith(novoTextarea);
                    }

                    
                    // Limpe os campos após a edição e o salvamento
                    $('#nome-campo-edit').val('');
                    $('#id-campo').val('');
                    $('#tipo-campo-edit').val('');
                    $('#nome-campo-edit').next("small").css('display', 'none')
                    $('.option-lista-edit .option-item').remove();
            }else{
                $('#nome-campo-edit').next("small").css('display', 'block')
               
            }
            
        });
    </script>


</body>
</html>